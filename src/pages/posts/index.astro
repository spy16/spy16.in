---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import { isBefore } from "date-fns";

const posts = (await getCollection("blog"))
	.filter((p) => !!p.data.publish)
	.sort((a, b) => (isBefore(a.data.pubDate, b.data.pubDate) ? 1 : -1));
---

<Layout title="Blog Posts">
	<main>
		<ul
			class="mt-12 flex flex-col gap-6 items-center w-full max-w-screen-md mx-auto px-2"
		>
			{
				posts.map((b) => (
					<li class="w-full flex flex-row gap-2 items-center">
						<div class="flex flex-col gap-1 items-center p-4">
							<span class="text-3xl font-extrabold">
								{b.data.pubDate.getDate()}
							</span>
							<span class="text-sm">
								{b.data.pubDate.toLocaleString("default", {
									year: "numeric",
									month: "short",
								})}
							</span>
						</div>

						<div class="flex flex-1 flex-col gap-2 justify-center">
							<a
								href={`/posts/${b.slug}`}
								class="text-xl font-bold link no-underline hover:underline w-fit"
							>
								{b.data.title}
							</a>

							<p>{b.data.description}</p>
						</div>
					</li>
				))
			}
		</ul>
	</main>
</Layout>
